開始日 2023/07/02  
読了日 2023/ * / *  
著者 Joel Grus 2020年4月28日初版

<!-- omit in toc -->
# 目次
- [1章 イントロダクション](#1章-イントロダクション)
- [2章 python速習](#2章-python速習)
- [3章 データの可視化](#3章-データの可視化)
- [4章 線形代数](#4章-線形代数)
  - [ベクトル](#ベクトル)
  - [行列](#行列)
- [5章 統計](#5章-統計)
  - [シンプソンのパラドクス](#シンプソンのパラドクス)
  - [相関係数についての注意点](#相関係数についての注意点)
  - [相関と因果関係](#相関と因果関係)
- [6章 確率](#6章-確率)
- [7章 仮説と推定](#7章-仮説と推定)

# 1章 イントロダクション
- Webサイトは全てのユーザーのクリックを全て記録してるし、スマートフォンは毎秒ごとに位置情報と移動方向の記録を読み上げている<br>
- 定量化主義者(Quantified selfers)は心拍数、運動量、摂取カロリー、睡眠パターンを常に記録するウェアラブルデバイスを付けている<br>
- スマートカーは運転パターンを、スマートホームは生活習慣を、スマートマーケットは購買パターンを収集する<br>

これらのデータに埋もれているのはこれまで誰もが考えたこともないような無数の問いに対する答えです。本書ではこれらを見つける方法を学ぶための本です。

**データサイエンティスト**は定義が曖昧なことが多いので、**本書においては大量の乱雑なデータから物事の本質を引き出す者**と定義します。<br>
例えば、
- 出会い系サイトOkCupid
  - 大量の質問をメンバーに行い、最も適した相手を見つける。同時に最初のデートで相手を退屈させないように、相手が興味を持たない分野を明らかにする分析を行う
- Facebook
  - これまで住んでいた場所と現在の居住地を尋ね、メンバーの友達を発見しやすくする。同時に移住パターンごとにフットボールチームの好みを分析したりもできる
- 大規模小売店Target
  - 実店舗とオンラインでの購買履歴及び挙動を記録し、顧客に子供が生まれる予定の有無や、いつ新生児関連の商品を売り込むべきであるかを予測するモデルの為にデータを使う
- その他
  - オバマの選挙運動での選挙手法の試み
  - データの活用による政府の効率化、ホームレスの救済、公衆衛生の向上

このようなデータを分析することで、物事の関係を見出し、効率的に行動を選択できるようする事ができるものを**データサイエンティスト**とする

そんなデータサイエンティストになるために統計的知識を本書を通して学びます

# 2章 python速習
内容があらかた既知なので割愛。[こちらを参照](../../Language/python/python%E9%80%9F%E7%BF%92/Basic.md)

# 3章 データの可視化
matplotlibの説明は別途用意したため割愛。[こちらを参照](../../Language/python/python%E9%80%9F%E7%BF%92/matplotlib.md)

# 4章 線形代数
線形代数は**ベクトル空間**を扱うための数学の分野
データサイエンスにおいてはあらゆる場面において線形代数が使われており、非常に重要であるためきちんと理解しておく必要がある

ここでは数学的なことはあまり詳しく書かない予定 (詳しくは[こちら](../../Mathmatical/)に記述)

## ベクトル
**ベクトル**とはいくつかの数値をまとめたオブジェクトであり、ベクトル同士の加算などで新しいベクトルを作成することができる。
例えば、身体のデータは、**[身長, 体重, 年齢]** の3次元のベクトルとして扱う事もできる。他にも座標などを **[x, y]** の2次元のベクトルとして扱うことも多い
(dot積やcross積などのベクトル特有の算術などについては[線形代数の資料](../../Mathmatical/)を参照)

以下、リストを使った各算術の実装を書くが、実際には**numpy**ライブラリを使った方が簡単に実装ができる。時短のため、numpyを前提とした書き方をしていく。(numpyについては[こちら](../../Language/python/python%E9%80%9F%E7%BF%92/numpy.md))
```python

from math import *

def add(a,b):
    assert len(a) == len(b)
    return [x + y for x,y in zip(a,b)]

def subtract(a,b):
    assert len(a) == len(b)
    return [x - y for x,y in zip(a,b)]

def product(a,b):
    assert len(a) == len(b)
    return [x * y for x,y in zip(a,b)]

def div(a,b):
    assert len(a) == len(b)
    return [x / y for x,y in zip(a,b)]

def dot(a,b):
    assert len(a) == len(b)
    num = 0
    for x,y in zip(a,b):
        num += x * y
    return num

def cross(a,b):
    assert len(a) == len(b)
    assert len(a) == 3
    return [a[1] * b[2] - a[2] * b[1],a[2] * b[0] - a[0] * b[2],a[0] * b[1] - a[1] * b[0]]

def L1norm(a):
    num = 0
    for x in a:
        num += abs(x)
    return num

def L2norm(a):
    return sqrt(dot(a,a))

def Linfnorm(a):
    return max(a)

a =[1,2,3]
b = [4,5,6]

print(add(a,b))
print(subtract(a,b))
print(product(a,b))
print(div(a,b))

print(dot(a,b))
print(cross(a,b))

print(L1norm(a))
print(L2norm(a))
print(Linfnorm(a))
```

## 行列
行列は数値は任意の整数n,mでn×mの二次元に配置したもの
横の並びを**行(row)** と呼び、縦の並びを**列(col)** と呼ぶ
(行列の詳細については[線形代数の資料](../../Mathmatical/linear%20algebra/Basic.md)を参照)

numpyを用いた行列へのアクセスなどの操作は以下の通りである
```python
import numpy as np
A = np.array([[1,2,3],
              [4,5,6]])

print(A.shape) # 行列の形状の取得
print(A.shape[0]) # rowの数
print(A.shape[1]) # colの数

print(A[1,:]) # 1行目を取り出し
print(A[:,0]) # 0列目を取り出し
```

また、numpyにおいては単位行列を**np.eye()**や**np.indentity()**で作成可能
```python
import numpy as np

eye = np.eye(5)
identity = np.identity(5)
print(eye,identity)
```

行列を使うことで複数人の身体特徴などのデータをベクトルとして、そのベクトルを行として扱う事ができるため非常に便利である。
また、人物の関係図などを構築するためにグラフを使う際などに、行が本人、列が繋がりのある人という風に管理する**隣接行列表現** に使用したりする。(ただし、グラフを表す際はデータ数が増えると、必要メモリ量が膨大になるため、基本的には**隣接リスト**が使われている)

データサイエンスに置ける行列の役割について簡単に説明してきたが、より詳しく線形代数について知りたい場合は[こちら](../../Mathmatical/linear%20algebra/Basic.md)を参照

# 5章 統計
**統計**とはデータを理解するための数学的手法である。
ただし、詳細な統計学についての知識については二度手間になるため、ここでは触れない。詳しく知りたい場合は[こちら](../../Mathmatical/%E7%B5%B1%E8%A8%88%E5%AD%A6/Basic.md)を参照

ここでは統計データを使う上で陥りがちな統計の注意点の例について触れる

## シンプソンのパラドクス
ある状況の違いを無視して得た相関係数が誤った結果を導くことがあるという現象を**シンプソンのパラドクス**という

例)
西海岸と東海岸のデータサイエンティストを名乗る人の友人関係のデータを集めて、平均の友達数を計算したら以下のようになった

|場所|人数|平均友達数|
|---|---|---|
|西海岸|101|8.2|
|東海岸|103|6.5|

この通り、西海岸の方が友達が多いように見える。
ここで、ここにPhDであるかどうかの基準を追加してみると以下のような結果になる

|場所|phd|人数|平均友達数|
|---|----|--|---|
|西海岸|あり|35|3.1|
|東海岸|あり|70|3.2|
|西海岸|なし|66|10.9|
|東海岸|なし|33|13.4|

このように学位の条件を加えると、東海岸の方が社交的であるという相関が得られ、相関が逆転している。
このように大きなくくりでデータを扱うと、学位の有無で相関が変わるという情報が隠れてしまう事がある。
これは大きなデータになるほど起こりやすい現象で、そのため、データを扱う際はこのような隠れた属性がないかなどデータについての理解を深めて、あらかじめこのような混乱を招く要因を排除できるようにすることが大切である。
(ただし、全体を見て西海岸の方が社交的という風に結論づけるのも大きな間違いではなく、今回のように200人程度の少ないデータ数であれば、単純に全体を見てしまっても良いかもしれない)


## 相関係数についての注意点
相関係数が0は二つのデータに線形的な関係がないことを示しているが、0だとしてもデータ間に関係がないとは限らない
例えば以下のようなデータがあるとする
```python
x = [-2,-1,0,1,2]
y = [2,1,0,1,2]
```
このデータの相関係数は0だが、yはxの絶対値という関係が存在している。
このように相関係数では見えない関係性も存在していることがある

また、相関が大きくても重要であるとは限らない点も考慮する必要がある
```python
x = [-2,-1,0,1,2]
y = [99.98.,99.99,100,100.01,100.02]
```
これらは完全な相関ではあるが、(何について比較しているかにもよるが)
データとしてこの相関が大きな意味を持つとはいえない(当然何について比較しているかによるが)

## 相関と因果関係
xとyの二つのデータに相関関係があったとしても、xがyの原因になっているという**因果関係**があるとは限らない事に注意する必要がある。

例えば、「体重が重い人程、ゼロカロリー飲料を飲む量が多い」という相関関係が得られたとします。
ここで、痩せてる人はそれほどゼロカロリー飲料を飲まない⇒ゼロカロリー飲料を飲むと体重が増加するという結論が間違いだということは明確である。
本質は体重が増えるのはゼロカロリー飲料ではなく、他の食生活が問題であり、太っている人はカロリーを気にしてゼロカロリー飲料を飲む割合が多いというのが原因である。
つまり、体重とゼロカロリー飲料に相関関係*はあれど、因果関係はないということである。

このように相関関係だけ見て対応を考えてしまうと、間違った判断をしてしまうため、本当に二つのデータ間に因果関係があるかどうかには十分注意する必要がある。

# 6章 確率
内容があらかた既知なので割愛。
数学的な詳しい内容は[こちら](../../Mathmatical/%E7%A2%BA%E7%8E%87/Basic.md)を参照

# 7章 仮説と推定

